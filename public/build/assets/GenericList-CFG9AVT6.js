import{r as i,j as e,m as C}from"./app-B8wn2_oF.js";import{M as S}from"./Modal-8Sv00nDZ.js";import{I as _,a as E}from"./InputPrice-BoHSCiy-.js";import{a as T}from"./Comment-q4ijhtHV.js";const y=i.forwardRef(function({type:t="text",className:s="",isFocused:u=!1,placeholder:m="",...c},f){const a=i.useRef(null);return i.useImperativeHandle(f,()=>({focus:()=>{var d;return(d=a.current)==null?void 0:d.focus()}})),i.useEffect(()=>{var d;u&&((d=a.current)==null||d.focus())},[u]),e.jsx("input",{...c,type:t,placeholder:m,className:"rounded-md border-gray-300 shadow-sm p-2 text-sm leading-none focus:border-indigo-500 focus:ring-indigo-500 dark:text-black "+s,ref:a})});function W({isOpen:o,onClose:t,listData:s,isDelete:u}){const{data:m,setData:c,post:f,processing:a}=C({title:(s==null?void 0:s.title)||"",price:(s==null?void 0:s.price)||0,date:(s==null?void 0:s.date)||"",is_shared:s!=null&&s.is_shared?1:0,images:(s==null?void 0:s.images)||"",memo:(s==null?void 0:s.memo)||""});i.useEffect(()=>{s&&c({title:s.title||"",price:s.price||0,date:s.date||"",is_shared:s.is_shared?1:0,images:s.images||"",memo:s.memo||""})},[s,c]);const d=r=>{r.preventDefault(),s!=null&&s.id&&f(`/household_edit/${s.id}`,{onSuccess:()=>{t()}})};return e.jsx(S,{show:o,onClose:t,maxWidth:"md",children:e.jsxs("form",{onSubmit:d,children:[e.jsx("div",{className:"relative mt-4 flex gap-4 items-center justify-center p-4 w-full",children:e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(_,{type:"date",value:m.date,onChange:r=>c("date",r.target.value)}),e.jsx(y,{type:"text",value:m.title,onChange:r=>c("title",r.target.value)}),e.jsx(E,{type:"number",value:m.price,className:"ml-auto w-full",onChange:r=>c("price",Number(r.target.value))}),e.jsx(y,{type:"text",value:m.memo,className:"w-full",onChange:r=>{c("memo",r.target.value)}})]})}),e.jsxs("div",{className:"mt-4 mx-auto w-full flex gap-4 justify-center items-start",children:[u&&s&&e.jsx("button",{onClick:()=>{u(s.id),t()},className:"border border-red-500 text-red-500 font-bold mb-5 px-4 py-2 rounded",children:"削除"}),e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded mb-5",type:"submit",disabled:a,children:"アップデート"})]}),e.jsx("button",{type:"button",className:"absolute top-0 right-0 p-1",onClick:t,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:24,height:24,children:e.jsx("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z",fill:"#666"})})})]})})}function z({className:o="",...t}){return e.jsx("input",{...t,type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500 "+o})}function X({data:o,comments:t,targetType:s,onEdit:u,onDelete:m,onComment:c,onToggleAchieve:f,userId:a,teamId:d}){var N;if(!o||!Array.isArray(o))return e.jsx("div",{className:"w-full my-10",children:"データが存在しません。"});const r=new Date,M=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,h=[...new Set(o.map(n=>n.date.slice(0,7)))].sort((n,l)=>n.localeCompare(l)),b=h.findIndex(n=>n===M),[w,v]=i.useState(null),[p,g]=i.useState(b>=0?b:0),[I,A]=i.useState([]),k=o.reduce((n,l)=>{const x=l.date.slice(0,7);return n[x]||(n[x]=[]),n[x].push(l),n},{});return e.jsxs("div",{className:"w-full my-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 py-2 border-b border-t border-gray-200",children:[e.jsx("button",{onClick:()=>g(n=>Math.max(n-1,0)),disabled:p===0,children:"←"}),e.jsx("span",{className:"font-medium text-lg",children:h[p]}),e.jsx("button",{onClick:()=>g(n=>Math.min(n+1,h.length-1)),disabled:p===h.length-1,children:"→"})]}),e.jsx("div",{className:"transition-transform duration-300 ease-in-out",onTouchStart:n=>v(n.touches[0].clientX),onTouchEnd:n=>{if(w===null)return;const l=n.changedTouches[0].clientX,x=w-l;Math.abs(x)>50&&(x>0?g(j=>Math.min(j+1,h.length-1)):g(j=>Math.max(j-1,0))),v(null)},children:e.jsx("ul",{className:"flex flex-col gap-4",children:(N=k[h[p]])==null?void 0:N.filter(n=>n.user_id==a||n.team_id===d||n.is_shared===0).map(n=>(I.includes(n.id),e.jsxs("li",{className:"flex flex-col gap-0 border-b pb-4",children:[e.jsxs("div",{className:"flex items-start justify-start",children:[e.jsx("ul",{className:"flex flex-col gap-1 w-full",children:e.jsxs("li",{className:"flex flex-col gap-1 w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[e.jsx(z,{name:"achieve",checked:n.achieve,onChange:l=>f(n.id,l.target.checked)}),e.jsx("time",{children:n.date}),e.jsx("p",{className:"flex-auto",children:n.title}),e.jsxs("p",{children:[n.price,"円"]})]}),n.memo&&n.memo.trim()!==""&&e.jsxs("p",{className:"pl-8",children:[e.jsx("span",{className:"text-white font-bold bg-gray-400 text-xs py-1 px-2 rounded-2xl mr-2",children:"メモ"}),n.memo]})]})}),e.jsx("button",{className:"flex items-center w-6 h-6 pl-2",onClick:()=>u(n),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 512",width:16,height:16,children:e.jsx("path",{d:"M64 360a56 56 0 1 0 0 112 56 56 0 1 0 0-112zm0-160a56 56 0 1 0 0 112 56 56 0 1 0 0-112zM120 96A56 56 0 1 0 8 96a56 56 0 1 0 112 0z"})})})]}),e.jsx(T,{className:"w-full mt-2",targetType:s,comment:t,comment_id:n.id,onWriteClick:()=>c(n)})]},n.id)))})})]})}export{W as E,y as I,X as L};
