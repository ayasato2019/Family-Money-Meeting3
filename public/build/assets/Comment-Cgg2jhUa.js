import{m as h,K as g,r as l,j as s}from"./app-pRJMbL3L.js";import{M as _}from"./Modal-DJwOOW9s.js";import{P as j}from"./PrimaryButton-DlBe487v.js";import{U as y}from"./AuthenticatedLayout-DnQ3aPJi.js";function C({isCommentOpen:o,onCommentClose:i,listData:e,onSubmit:f}){const{data:n,setData:r,post:a,processing:u,reset:t}=h({id:0,team_id:0,user_id_to:0,target_id:0,target_type:0,comment:""}),{auth:c,comments:m,team_id:d}=g().props;l.useEffect(()=>{e&&e.comment_id!==0&&e.target_type!==0?r({comment:e.comment,id:e.id,team_id:d??0,target_id:e.target_id,target_type:e.target_type,user_id_to:e.user_id_to}):e&&r({comment:"",id:e.id,team_id:d??0,target_id:e.target_id,target_type:e.target_type,user_id_to:e.user_id_to||c.user.id})},[e,c.user.id]),l.useEffect(()=>{o||t()},[o,t]);const x=p=>{p.preventDefault(),e&&a("/comments",{...n,onSuccess:()=>{i(),t()}})};return s.jsx(_,{show:o,onClose:i,maxWidth:"md",children:s.jsx("form",{onSubmit:x,children:s.jsxs("div",{className:"relative p-6",children:[s.jsxs("p",{className:"flex gap-2 text-lg font-medium mb-4",children:[s.jsx("span",{className:"text-gray-500",children:(e==null?void 0:e.date)??""}),(e==null?void 0:e.title)??"タイトルなし"]}),s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"flex flex-col gap-2",children:s.jsx("input",{id:"comment",type:"text",value:n.comment,onChange:p=>r("comment",p.target.value),className:"border rounded p-2",required:!0})})}),s.jsx("div",{className:"mt-6 flex gap-4 justify-end",children:s.jsx(j,{type:"submit",disabled:u,children:"コメント"})}),s.jsx("button",{type:"button",className:"absolute top-0 right-0 p-1",onClick:i,children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:24,height:24,children:s.jsx("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z",fill:"#666"})})})]})})})}function M({className:o,comment:i=[],user_id:e,comment_id:f,targetType:n,onWriteClick:r}){const[a,u]=l.useState([]),t=f;return l.useEffect(()=>{(async()=>{if(t&&t!==0)try{const d=await(await fetch(`/comments/${n}/${t}`)).json();u(Array.isArray(d)?d:[])}catch(m){console.error("コメントの取得に失敗しました:",m)}})()},[n,t]),s.jsx("div",{className:`flex items-center justify-end ${o||""}`,children:a.length===0?s.jsx("button",{onClick:()=>{console.log("Comment button clicked"),r&&r()},children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:18,height:16,className:"fill-gray-500",children:s.jsx("path",{d:"M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"})})}):s.jsx("ul",{className:"w-full space-y-1",children:a.map((c,m)=>s.jsxs("li",{className:"flex items-center justify-end gap-2 flex-nowrap w-full",children:[s.jsx("span",{className:"balloon right",children:c.comment}),s.jsx(y,{userId:c.user_id_from,allowUpload:!1})]},m))})})}export{C,M as a};
